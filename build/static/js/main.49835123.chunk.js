(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){},166:function(e,t,n){e.exports=n(368)},171:function(e,t,n){},175:function(e,t,n){},364:function(e,t,n){},368:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(7),i=n.n(s),o=(n(171),n(111)),c=n(163),l=n(22),u=n.n(l),p=n(42),m=n(32),d=n(33),h=n(35),f=n(34),g=n(36),b=(n(175),n(150)),v=n.n(b),E=n(43),S=n.n(E);S.a.defaults.baseURL="http://60.190.81.133:9010/",S.a.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)}),S.a.interceptors.response.use(function(e){var t=e.data;return t},function(e){return Promise.reject(e)});var O=function(e){var t=!1;return{promise:new Promise(function(n,a){e.then(function(e){return t?a({isCanceled:!0}):n(e)},function(e){return a(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}},x={getOSList:"".concat("/v2/superinspire","/getOSList"),getOS:"".concat("/v2/superinspire","/getOS"),rmOS:"".concat("/v2/superinspire","/rmOS")},C=function(){return O(S.a.get(x.getOSList))},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:80;return O(S.a.get(x.getOS,{params:{os:e,timeout:t,cpu:n,mem:a,port:r}}))},y=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.floor((new Date).getTime()/1e3);return O(S.a.get(x.rmOS,{params:{containerId:e,shareUrl:t,timestamp:n}}))},w=n(151),j=n.n(w),_=function(e,t){return localStorage.setItem(e,t)},P=function(e){return localStorage.getItem(e)},L=function(e){return localStorage.removeItem(e)},V=n(369),I=n(372),U=n(376),N=n(109),M=n(374),T=(n(132),n(3)),D=n.n(T),F=n(377),A=n(373),J=n(378),$=n(370),q=n(371),W=n(375),z=(F.a.Step,I.a.Meta,A.a.Option,q.a.Item),G={port:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3\u53f7"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=65535||""===t)return n();n("\u7aef\u53e3\u53f7\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u7aef\u53e3\u53f7\u8303\u56f4\uff1a 1 ~ 65535"}],cpu:[{required:!0,message:"\u8bf7\u8f93\u5165 CPU \u6838\u6570"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=4||""===t)return n();n("CPU \u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"CPU \u8303\u56f4\uff1a1 ~ 4"}],mem:[{required:!0,message:"\u8bf7\u8f93\u5165\u7a7a\u95f4\u5927\u5c0f"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=3584||""===t)return n();n("\u7a7a\u95f4\u5927\u5c0f\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u7a7a\u95f4\u5927\u5c0f\u8303\u56f4\uff1a1 ~ 3584"}],timeout:[{required:!0,message:"\u8bf7\u8f93\u5165\u4f7f\u7528\u65f6\u957f"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=24||""===t)return n();n("\u4f7f\u7528\u65f6\u957f\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u4f7f\u7528\u65f6\u957f\u8303\u56f4\uff1a1 ~ 24"}]},B=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){n.props.getForm&&n.props.getForm(n.props.form)},n.state={},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:10},wrapperCol:{span:14}};return r.a.createElement(q.a,{layout:"horizontal"},r.a.createElement(z,Object.assign({label:"\u7aef\u53e3\u53f7"},t),e("port",{initialValue:"80",rules:G.port})(r.a.createElement(W.a,{style:{width:200},placeholder:"\u5982\uff1a80"}))),r.a.createElement(z,Object.assign({label:"CPU \u6838\u6570"},t),e("cpu",{initialValue:"1",rules:G.cpu})(r.a.createElement(W.a,{style:{width:200},placeholder:"\u5982\uff1a1"}))),r.a.createElement(z,Object.assign({label:"\u7a7a\u95f4\u5927\u5c0f\uff08M\uff09"},t),e("mem",{initialValue:"512",rules:G.mem})(r.a.createElement(W.a,{style:{width:200},placeholder:"\u5982\uff1a512"}))),r.a.createElement(z,Object.assign({label:"\u4f7f\u7528\u65f6\u957f\uff08h\uff09"},t),e("timeout",{initialValue:"24",rules:G.timeout})(r.a.createElement(W.a,{style:{width:200},placeholder:"\u5982\uff1a24"}))))}}]),t}(r.a.Component);B.defaultProps={};var H=q.a.create()(B),R=(n(364),{labelCol:{span:12},wrapperCol:{span:12}}),K=q.a.Item,Q=function(e){return r.a.createElement("span",{style:{display:"inline-block",width:80,textAlign:"left"}},e)},X=function(e){function t(){var e,n;Object(m.a)(this,t);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(i)))).getSystemVersion=function(){var e=n.props,t=e.system,s=e.version;return r.a.createElement(a.Fragment,null,t,r.a.createElement(V.a,{type:"vertical"}),s)},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.cpu,n=e.mem,a=e.timeout,s=e.showInnerPort,i=e.showExternalPort,o=e.innerPort,c=e.externalPort;return r.a.createElement(q.a,null,r.a.createElement(K,Object.assign({label:Q("\u7cfb\u7edf")},R),this.getSystemVersion()),r.a.createElement(K,Object.assign({label:Q("\u7aef\u53e3\u53f7")},R),o),r.a.createElement(K,Object.assign({label:Q("CPU \u6838\u6570")},R),t," \u6838"),r.a.createElement(K,Object.assign({label:Q("\u7a7a\u95f4\u5927\u5c0f")},R),n," M\uff08",(n/1024).toFixed(2)," G\uff09"),r.a.createElement(K,Object.assign({label:Q("\u4f7f\u7528\u65f6\u957f")},R),a," \u5c0f\u65f6"),s&&r.a.createElement(K,Object.assign({label:Q("\u5185\u90e8\u7aef\u53e3\u53f7")},R),o),i&&r.a.createElement(K,Object.assign({label:Q("\u5916\u90e8\u7aef\u53e3\u53f7")},R),c))}}]),t}(r.a.Component);X.defaultProps={showInnerPort:!1,showExternalPort:!1};var Y=q.a.create()(X),Z=F.a.Step,ee=A.a.Option,te=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){n.getOSList()},n.getCurrentStep=function(){return 0},n.isExistContainer=function(){var e=P("containerInfo");return e?(e=JSON.parse(e),Math.floor((new Date).getTime()/1e3)<e.timeout?{isExistContainer:!0,container:e}:void 0):{isExistContainer:!1,container:{}}},n.getOSList=Object(p.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),n.p1=C(),e.prev=2,e.next=5,n.p1.promise;case 5:t=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",J.a.error(e.t0.message));case 11:n.setState({loading:!1,osList:t});case 12:case"end":return e.stop()}},e,this,[[2,8]])})),n.handleSelectChange=function(e,t){var a=[],r={index:t,osCode:e};a[t]=r,n.setState({selectsObj:a})},n.handleNextStep=function(){var e=n.state,t=e.currentStep,a=e.selectsObj,r=e.port;if(0===t&&!a.length)return J.a.error("\u8bf7\u5148\u9009\u62e9\u7cfb\u7edf\u548c\u7cfb\u7edf\u7248\u672c");if(1===t){var s=!/\d./.test(r);if(!r||s)return J.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7aef\u53e3\u53f7")}n.setState({currentStep:n.state.currentStep+1})},n.handlePreStep=function(){n.setState({currentStep:n.state.currentStep-1})},n.handlePortChange=function(e){var t=e.target.value;n.setState({port:t})},n.handleGetForm=function(e){n._form=e},n._values={},n.handleCreate=function(){(0,n._form.validateFields)(function(){var e=Object(p.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",J.a.error("\u6027\u80fd\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199"));case 2:n.setState({modalVisible:!0}),n._values=a;case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())},n.handleOk=Object(p.a)(u.a.mark(function e(){var t,a,r,s,i,o,c,l,p,m,d,h;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({okLoading:!0}),t=n.state.selectsObj,a=t.filter(function(e){return e})[0].osCode,r=n._values,s=r.timeout,i=r.cpu,o=r.mem,c=r.port,l=Math.floor((new Date).getTime()/1e3)+60*s*60,n.p2=k(a,l,i,o,c),!(s||i||o||c)){e.next=17;break}return e.prev=7,e.next=10,n.p2.promise;case 10:p=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(7),e.abrupt("return",console.error(e.t0));case 16:p.shareUrl&&p.containerId&&p.statusCode&&p.openPort?(n.setState({open:!1,container:p,isExistContainer:!0,modalVisible:!1,skipModalVisible:!0}),m=n.getSystemVersion(),d=m.system,h=m.version,_("containerInfo",JSON.stringify({system:d,version:h,port:c,cpu:i,mem:o,timeout:l,timeoutH:s,innerPort:c,externalPort:p.openPort,shareUrl:p.shareUrl,containerId:p.containerId})),n.props.okCallback(!0,{shareUrl:p.shareUrl,timeout:l,containerId:p.containerId}),n._shareUrl=p.shareUrl):(n.setState({okLoading:!1}),J.a.error("\u521b\u5efa\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"));case 17:case"end":return e.stop()}},e,this,[[7,13]])})),n.generateStepsContent=function(){n.steps[0].content=r.a.createElement(a.Fragment,null,n.state.osList.map(function(e,t){var a,s=n.state.selectsObj;s[t]&&(a=s[t].osCode);var i=D()({isSelect:!!s[t]});return r.a.createElement(I.a,{key:e.label,style:{width:200,margin:"10px 25px"}},r.a.createElement("div",{style:{textAlign:"center"}},e.label),r.a.createElement("img",{style:{display:"block",width:120,height:120,margin:"0 auto"},className:i,src:e.logoUrl,alt:e.label}),r.a.createElement(A.a,{value:a,onChange:function(e){return n.handleSelectChange(e,t)},style:{width:182,marginTop:10},placeholder:"\u8bf7\u9009\u62e9\u7cfb\u7edf\u7248\u672c"},e.subList.map(function(e){return r.a.createElement(ee,{key:e.label,value:e.osCode},e.label)})))})),n.steps[1].content=r.a.createElement(H,{getForm:n.handleGetForm})},n.getSystemVersion=function(){var e=n.state,t=e.selectsObj,a=e.osList;if(!t.length||!a.length)return{system:"",version:""};var r=t.filter(function(e){return e})[0],s=a[r.index].subList;return{system:a[r.index].label,version:s.find(function(e){return e.osCode===r.osCode}).label}};var s=n.getCurrentStep(),i=n.isExistContainer(),o=i.isExistContainer,c=i.container;return n.state={osList:[],loading:!1,okLoading:!1,currentStep:s,osCode:0,selectsObj:[],port:"80",modalVisible:!1,isExistContainer:o,container:c,skipModalVisible:!1},n.steps=[{title:"\u7cfb\u7edf",desc:"\u9009\u62e9\u7cfb\u7edf",content:""},{title:"\u6027\u80fd\u53c2\u6570",desc:"\u586b\u5199\u7cfb\u7edf\u6027\u80fd\u53c2\u6570",content:""}],n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=(t.osList,t.loading),a=t.okLoading,s=t.currentStep,i=(t.skipModalVisible,this.getSystemVersion()),o=i.system,c=i.version;return this.generateStepsContent(),r.a.createElement($.a,{spinning:n},r.a.createElement("div",{className:"select-system-config"},r.a.createElement("div",null,r.a.createElement(F.a,{current:s},this.steps.map(function(e){return r.a.createElement(Z,{key:e.title,title:e.title,description:e.desc})}))),r.a.createElement(V.a,null),r.a.createElement("div",{className:"select-system-config__step-content"},this.steps[s].content),r.a.createElement("div",{className:" select-system-config__steps-action"},r.a.createElement(N.a,{type:"primary",disabled:0===s,onClick:this.handleCreate},"\u521b\u5efa"),r.a.createElement(N.a,{disabled:1===s,onClick:this.handleNextStep},"\u4e0b\u4e00\u6b65"),r.a.createElement(N.a,{disabled:0===s,onClick:this.handlePreStep},"\u4e0a\u4e00\u6b65"))),r.a.createElement(M.a,{title:"\u6240\u9009\u7cfb\u7edf\u53ca\u7cfb\u7edf\u914d\u7f6e",visible:this.state.modalVisible,onOk:this.handleOk,onCancel:function(){return e.setState({modalVisible:!1})},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement($.a,{spinning:a},r.a.createElement(Y,{system:o,version:c,innerPort:this._values.port,cpu:this._values.cpu,mem:this._values.mem,timeout:this._values.timeout}))))}}]),t}(r.a.Component);te.defaultProps={};var ne=te,ae=function(e){function t(e){var n,a;Object(m.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).componentDidMount=function(){a.getOSList(),a.subscribeEvent(),a.typed=new v.a(".app__desc-content",{strings:["Want to experiment with something on a Linux distribution? Let's start!"],typeSpeed:50})},a.componentWillUnmount=function(){},a.isExistContainer=function(){var e=P("containerInfo");return e?(e=JSON.parse(e),Math.floor((new Date).getTime()/1e3)<e.timeout?{isExistContainer:!0,container:e}:void 0):{isExistContainer:!1,container:{}}},a.subscribeEvent=function(){},a.getOSList=Object(p.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.p1=C(),e.prev=1,e.next=4,a.p1.promise;case 4:t=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",console.error(e.t0));case 10:(n=t).length&&(n[0].selected=!0),a.setState({osList:n});case 13:case"end":return e.stop()}},e,this,[[1,7]])})),a.handleStartClick=function(){},a.handleClose=function(){a.setState({open:!1})},a.handleOSSelect=function(e){var t=Object(c.a)(a.state.osList),n=t.findIndex(function(t){return e.label===t.label});t.forEach(function(e,t){n===t&&(e.selected=!1),e.selected=n===t}),a.setState({osList:t})},a.handleOSVersionSelect=function(e,t){a.setState({open:!0,selectedOS:e,selectedVersion:t})},a.handleSelectAgain=Object(p.a)(u.a.mark(function e(){var t,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({screenLoading:!0,screenText:"\u5220\u9664\u4e2d..."}),t=a.state.container,n=Math.floor((new Date).getTime()/1e3),a.p3=y(t.containerId,t.shareUrl,n),e.prev=4,e.next=7,a.p3.promise;case 7:r=e.sent,e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",console.error(e.t0));case 13:if(1===r.statusCode){e.next=16;break}return a.setState({screenLoading:!1}),e.abrupt("return",console.error(r.message));case 16:a.setState({isExistContainer:!1,container:{},screenLoading:!1}),L("containerInfo");case 18:case"end":return e.stop()}},e,this,[[4,10]])})),a.handleOkCallback=function(){var e=a.isExistContainer(),t=e.isExistContainer,n=e.container;a.setState({isExistContainer:t,container:n,skipModalVisible:!0})};var r=a.isExistContainer(),s=r.isExistContainer,i=r.container;return a.state=(n={open:!1,osList:[],selectedVersion:{},selectedOS:{},timeout:24,cpu:1,memory:512,port:80,container:i,isExistContainer:s,screenLoading:!1,externalPort:0},Object(o.a)(n,"port",0),Object(o.a)(n,"skipModalVisible",!1),n),a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.isExistContainer,a=t.screenLoading,s=t.screenText,i=(t.externalPort,t.port,t.container);return r.a.createElement(j.a,{loading:a,bgColor:"#d0d0d0",spinnerColor:"#252525",textColor:"#676767",text:s},r.a.createElement("div",{className:"app"},r.a.createElement("h1",{className:"app__title"},r.a.createElement("span",{className:"app__title-span"},"Super Inspire")),r.a.createElement("div",{className:"app__desc"},r.a.createElement("div",{className:"app__text-editor-wrap"},r.a.createElement("div",{className:"app__title-bar"},"Arch Linux/Debian/CentOS/Defora/Ubuntu/Ubuntu\u884d\u751f\u7248/Deepin/LineageOS/openSUSE"),r.a.createElement("div",{className:"app__text-body"},r.a.createElement("span",{style:{marginRight:10}},"$"),r.a.createElement("span",{className:"app__desc-content"})))),r.a.createElement(V.a,{style:{marginTop:100}},n?"\u60a8\u5df2\u521b\u5efa\u7cfb\u7edf":"\u9009\u62e9\u7cfb\u7edf\u914d\u7f6e"),n&&r.a.createElement(I.a,null,r.a.createElement("div",{className:"app__ports"},r.a.createElement(Y,{showInnerPort:!0,showExternalPort:!0,system:i.system,version:i.version,cpu:i.cpu,mem:i.mem,timeout:i.timeoutH,innerPort:i.innerPort,externalPort:i.externalPort}))),r.a.createElement("div",{className:"app__os-list"},n?r.a.createElement("div",{style:{marginTop:20,textAlign:"center"}},r.a.createElement(U.a,{title:"\u82e5\u6253\u5f00\u7684\u9875\u9762\u62a5\u9519\uff0c\u8bf7\u91cd\u65b0\u70b9\u51fb"},r.a.createElement(N.a,{size:"large",color:"primary",variant:"outlined",onClick:function(){var e=JSON.parse(P("containerInfo"));window.open(e.shareUrl)},style:{margin:10}},"\u6253\u5f00\u5df2\u521b\u5efa\u7684\u7cfb\u7edf")),r.a.createElement(N.a,{size:"large",color:"secondary",variant:"outlined",onClick:this.handleSelectAgain,style:{margin:10}},"\u91cd\u65b0\u9009\u62e9")):r.a.createElement(ne,{okCallback:this.handleOkCallback}))),r.a.createElement(M.a,{title:"\u63d0\u793a",visible:this.state.skipModalVisible,onOk:function(){window.open(e.state.container.shareUrl),e.setState({skipModalVisible:!1})},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onCancel:function(){return e.setState({skipModalVisible:!1})}},r.a.createElement("p",null,"\u7cfb\u7edf\u5df2\u521b\u5efa\uff0c\u662f\u5426\u8df3\u8f6c\u5230\u7cfb\u7edf\u9875\u9762\uff1f")))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(366);i.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[166,2,1]]]);
//# sourceMappingURL=main.49835123.chunk.js.map