(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(e,t,n){},165:function(e,t,n){e.exports=n(365)},170:function(e,t,n){},174:function(e,t,n){},365:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(7),i=n.n(s),o=(n(170),n(162)),c=n(22),l=n.n(c),u=n(37),p=n(45),m=n(46),d=n(51),h=n(47),f=n(52),g=(n(174),n(149)),b=n.n(g),v=n(38),E=n.n(v);E.a.defaults.baseURL="http://60.190.81.133:9010/",E.a.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)}),E.a.interceptors.response.use(function(e){var t=e.data;return t},function(e){return Promise.reject(e)});var S=function(e){var t=!1;return{promise:new Promise(function(n,a){e.then(function(e){return t?a({isCanceled:!0}):n(e)},function(e){return a(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}},O={getOSList:"".concat("/v2/superinspire","/getOSList"),getOS:"".concat("/v2/superinspire","/getOS"),rmOS:"".concat("/v2/superinspire","/rmOS")},C=function(){return S(E.a.get(O.getOSList))},x=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:80;return S(E.a.get(O.getOS,{params:{os:e,timeout:t,cpu:n,mem:a,port:r}}))},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.floor((new Date).getTime()/1e3);return S(E.a.get(O.rmOS,{params:{containerId:e,shareUrl:t,timestamp:n}}))},w=n(150),y=n.n(w),j=function(e,t){return localStorage.setItem(e,t)},L=function(e){return localStorage.getItem(e)},_=function(e){return localStorage.removeItem(e)},I=n(366),U=n(373),N=n(108),P=(n(131),n(3)),D=n.n(P),M=n(374),T=n(369),V=n(370),F=n(368),J=n(375),$=n(367),q=n(371),A=n(372),W=(M.a.Step,T.a.Meta,V.a.Option,F.a.Item),z={port:[{required:!0,message:"\u8bf7\u8f93\u5165\u7aef\u53e3\u53f7"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=65535||""===t)return n();n("\u7aef\u53e3\u53f7\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u7aef\u53e3\u53f7\u8303\u56f4\uff1a 1 ~ 65535"}],cpu:[{required:!0,message:"\u8bf7\u8f93\u5165 CPU \u6838\u6570"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=4||""===t)return n();n("CPU \u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"CPU \u8303\u56f4\uff1a1 ~ 4"}],mem:[{required:!0,message:"\u8bf7\u8f93\u5165\u7a7a\u95f4\u5927\u5c0f"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=3584||""===t)return n();n("\u7a7a\u95f4\u5927\u5c0f\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u7a7a\u95f4\u5927\u5c0f\u8303\u56f4\uff1a1 ~ 3584"}],timeout:[{required:!0,message:"\u8bf7\u8f93\u5165\u4f7f\u7528\u65f6\u957f"},{validator:function(e,t,n){if(/^\d+$/g.test(t)&&t>=1&&t<=24||""===t)return n();n("\u4f7f\u7528\u65f6\u957f\u683c\u5f0f\u6216\u8303\u56f4\u6709\u8bef")},message:"\u4f7f\u7528\u65f6\u957f\u8303\u56f4\uff1a1 ~ 24"}]},G=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){n.props.getForm&&n.props.getForm(n.props.form)},n.state={},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:10},wrapperCol:{span:14}};return r.a.createElement(F.a,{layout:"horizontal"},r.a.createElement(W,Object.assign({label:"\u7aef\u53e3\u53f7"},t),e("port",{initialValue:"80",rules:z.port})(r.a.createElement(A.a,{style:{width:200},placeholder:"\u5982\uff1a80"}))),r.a.createElement(W,Object.assign({label:"CPU \u6838\u6570"},t),e("cpu",{initialValue:"1",rules:z.cpu})(r.a.createElement(A.a,{style:{width:200},placeholder:"\u5982\uff1a1"}))),r.a.createElement(W,Object.assign({label:"\u7a7a\u95f4\u5927\u5c0f\uff08M\uff09"},t),e("mem",{initialValue:"512",rules:z.mem})(r.a.createElement(A.a,{style:{width:200},placeholder:"\u5982\uff1a512"}))),r.a.createElement(W,Object.assign({label:"\u4f7f\u7528\u65f6\u957f\uff08h\uff09"},t),e("timeout",{initialValue:"24",rules:z.timeout})(r.a.createElement(A.a,{style:{width:200},placeholder:"\u5982\uff1a24"}))))}}]),t}(r.a.Component);G.defaultProps={};var B=F.a.create()(G),R=M.a.Step,H=(T.a.Meta,V.a.Option),K=F.a.Item,Q={labelCol:{span:10},wrapperCol:{span:14}},X=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){n.getOSList()},n.getCurrentStep=function(){return 0},n.isExistContainer=function(){var e=L("containerInfo");return e?(e=JSON.parse(e),Math.floor((new Date).getTime()/1e3)<e.timeout?{isExistContainer:!0,container:e}:void 0):{isExistContainer:!1,container:{}}},n.getOSList=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0}),n.p1=C(),e.prev=2,e.next=5,n.p1.promise;case 5:t=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",J.a.error(e.t0.message));case 11:n.setState({loading:!1,osList:t});case 12:case"end":return e.stop()}},e,this,[[2,8]])})),n.handleSelectChange=function(e,t){var a=[],r={index:t,osCode:e};a[t]=r,n.setState({selectsObj:a})},n.handleNextStep=function(){var e=n.state,t=e.currentStep,a=e.selectsObj,r=e.port;if(0===t&&!a.length)return J.a.error("\u8bf7\u5148\u9009\u62e9\u7cfb\u7edf\u548c\u7cfb\u7edf\u7248\u672c");if(1===t){var s=!/\d./.test(r);if(!r||s)return J.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7aef\u53e3\u53f7")}n.setState({currentStep:n.state.currentStep+1})},n.handlePreStep=function(){n.setState({currentStep:n.state.currentStep-1})},n.handlePortChange=function(e){var t=e.target.value;n.setState({port:t})},n.handleGetForm=function(e){n._form=e},n._values={},n.handleCreate=function(){(0,n._form.validateFields)(function(){var e=Object(u.a)(l.a.mark(function e(t,a){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",J.a.error("\u6027\u80fd\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u586b\u5199"));case 2:n.setState({modalVisible:!0}),n._values=a;case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}())},n.handleOk=Object(u.a)(l.a.mark(function e(){var t,a,r,s,i,o,c,u,p;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({okLoading:!0}),t=n.state.selectsObj,a=t.filter(function(e){return e})[0].osCode,r=n._values,s=r.timeout,i=r.cpu,o=r.mem,c=r.port,u=Math.floor((new Date).getTime()/1e3)+60*s*60,n.p2=x(a,u,i,o,c),!(s||i||o||c)){e.next=17;break}return e.prev=7,e.next=10,n.p2.promise;case 10:p=e.sent,e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(7),e.abrupt("return",console.error(e.t0));case 16:p.shareUrl&&p.containerId&&p.statusCode?(n.setState({open:!1,container:p,isExistContainer:!0}),j("containerInfo",JSON.stringify({shareUrl:p.shareUrl,timeout:u,containerId:p.containerId})),n.props.okCallback(!0,{shareUrl:p.shareUrl,timeout:u,containerId:p.containerId}),window.open(p.shareUrl)):(n.setState({okLoading:!1}),J.a.error("\u521b\u5efa\u5931\u8d25"));case 17:case"end":return e.stop()}},e,this,[[7,13]])})),n.generateStepsContent=function(){n.steps[0].content=r.a.createElement(a.Fragment,null,n.state.osList.map(function(e,t){var a,s=n.state.selectsObj;s[t]&&(a=s[t].osCode);var i=D()({isSelect:!!s[t]});return r.a.createElement(T.a,{key:e.label,style:{width:200,margin:"10px 25px"}},r.a.createElement("div",{style:{textAlign:"center"}},e.label),r.a.createElement("img",{style:{display:"block",width:120,height:120,margin:"0 auto"},className:i,src:e.logoUrl,alt:e.label}),r.a.createElement(V.a,{value:a,onChange:function(e){return n.handleSelectChange(e,t)},style:{width:182,marginTop:10},placeholder:"\u8bf7\u9009\u62e9\u7cfb\u7edf\u7248\u672c"},e.subList.map(function(e){return r.a.createElement(H,{key:e.label,value:e.osCode},e.label)})))})),n.steps[1].content=r.a.createElement(B,{getForm:n.handleGetForm})},n.getSystem=function(){var e=n.state,t=e.selectsObj,s=e.osList;if(t.length&&s.length){var i=t.filter(function(e){return e})[0],o=s[i.index].subList,c=s[i.index].label,l=o.find(function(e){return e.osCode===i.osCode});return r.a.createElement(a.Fragment,null,c,r.a.createElement(I.a,{type:"vertical"}),l.label)}};var s=n.getCurrentStep(),i=n.isExistContainer(),o=i.isExistContainer,c=i.container;return n.state={osList:[],loading:!1,okLoading:!1,currentStep:s,osCode:0,selectsObj:[],port:"80",modalVisible:!1,isExistContainer:o,container:c},n.steps=[{title:"\u7cfb\u7edf",desc:"\u9009\u62e9\u7cfb\u7edf",content:""},{title:"\u6027\u80fd\u53c2\u6570",desc:"\u586b\u5199\u7cfb\u7edf\u6027\u80fd\u53c2\u6570",content:""}],n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=(t.osList,t.loading),a=t.okLoading,s=t.currentStep;return this.generateStepsContent(),r.a.createElement($.a,{spinning:n},r.a.createElement("div",{className:"select-system-config"},r.a.createElement("div",null,r.a.createElement(M.a,{current:s},this.steps.map(function(e){return r.a.createElement(R,{key:e.title,title:e.title,description:e.desc})}))),r.a.createElement(I.a,null),r.a.createElement("div",{className:"select-system-config__step-content"},this.steps[s].content),r.a.createElement("div",{className:" select-system-config__steps-action"},r.a.createElement(N.a,{type:"primary",disabled:0===s,onClick:this.handleCreate},"\u521b\u5efa"),r.a.createElement(N.a,{disabled:1===s,onClick:this.handleNextStep},"\u4e0b\u4e00\u6b65"),r.a.createElement(N.a,{disabled:0===s,onClick:this.handlePreStep},"\u4e0a\u4e00\u6b65"))),r.a.createElement(q.a,{title:"\u6240\u9009\u7cfb\u7edf\u53ca\u7cfb\u7edf\u914d\u7f6e",visible:this.state.modalVisible,onOk:this.handleOk,onCancel:function(){return e.setState({modalVisible:!1})},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},r.a.createElement($.a,{spinning:a},r.a.createElement(F.a,null,r.a.createElement(K,Object.assign({label:"\u7cfb\u7edf"},Q),this.getSystem()),r.a.createElement(K,Object.assign({label:"\u7aef\u53e3\u53f7"},Q),this._values.port),r.a.createElement(K,Object.assign({label:"CPU \u6838\u6570"},Q),this._values.cpu," \u6838"),r.a.createElement(K,Object.assign({label:"\u7a7a\u95f4\u5927\u5c0f"},Q),this._values.mem," M\uff08",(this._values.mem/1024).toFixed(2)," G\uff09"),r.a.createElement(K,Object.assign({label:"\u4f7f\u7528\u65f6\u957f"},Q),this._values.timeout," \u5c0f\u65f6")))))}}]),t}(r.a.Component);X.defaultProps={};var Y=X,Z=function(e){function t(e){var n;Object(p.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){n.getOSList(),n.subscribeEvent(),n.typed=new b.a(".app__desc-content",{strings:["Want to experiment with something on a Linux distribution? Let's start!"],typeSpeed:50})},n.componentWillUnmount=function(){},n.isExistContainer=function(){var e=L("containerInfo");return e?(e=JSON.parse(e),Math.floor((new Date).getTime()/1e3)<e.timeout?{isExistContainer:!0,container:e}:void 0):{isExistContainer:!1,container:{}}},n.subscribeEvent=function(){},n.getOSList=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.p1=C(),e.prev=1,e.next=4,n.p1.promise;case 4:t=e.sent,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",console.error(e.t0));case 10:(a=t).length&&(a[0].selected=!0),n.setState({osList:a});case 13:case"end":return e.stop()}},e,this,[[1,7]])})),n.handleStartClick=function(){},n.handleClose=function(){n.setState({open:!1})},n.handleOSSelect=function(e){var t=Object(o.a)(n.state.osList),a=t.findIndex(function(t){return e.label===t.label});t.forEach(function(e,t){a===t&&(e.selected=!1),e.selected=a===t}),n.setState({osList:t})},n.handleOSVersionSelect=function(e,t){n.setState({open:!0,selectedOS:e,selectedVersion:t})},n.handleSelectAgain=Object(u.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({screenLoading:!0,screenText:"\u5220\u9664\u4e2d..."}),t=n.state.container,a=Math.floor((new Date).getTime()/1e3),n.p3=k(t.containerId,t.shareUrl,a),e.prev=4,e.next=7,n.p3.promise;case 7:r=e.sent,e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",console.error(e.t0));case 13:if(1===r.statusCode){e.next=16;break}return n.setState({screenLoading:!1}),e.abrupt("return",console.error(r.message));case 16:n.setState({isExistContainer:!1,container:{},screenLoading:!1}),_("containerInfo");case 18:case"end":return e.stop()}},e,this,[[4,10]])})),n.handleOkCallback=function(e,t){n.setState({isExistContainer:e,container:t})};var a=n.isExistContainer(),r=a.isExistContainer,s=a.container;return n.state={open:!1,osList:[],selectedVersion:{},selectedOS:{},timeout:24,cpu:1,memory:512,port:80,container:s,isExistContainer:r,screenLoading:!1},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.isExistContainer,n=e.screenLoading,a=e.screenText;return r.a.createElement(y.a,{loading:n,bgColor:"#d0d0d0",spinnerColor:"#252525",textColor:"#676767",text:a},r.a.createElement("div",{className:"app"},r.a.createElement("h1",{className:"app__title"},r.a.createElement("span",{className:"app__title-span"},"Super Inspire")),r.a.createElement("div",{className:"app__desc"},r.a.createElement("div",{className:"app__text-editor-wrap"},r.a.createElement("div",{className:"app__title-bar"},"Arch Linux/Debian/CentOS/Defora/Ubuntu/Ubuntu\u884d\u751f\u7248/Deepin/LineageOS/openSUSE"),r.a.createElement("div",{className:"app__text-body"},r.a.createElement("span",{style:{marginRight:10}},"$"),r.a.createElement("span",{className:"app__desc-content"})))),r.a.createElement(I.a,{style:{marginTop:100}},t?"\u60a8\u5df2\u521b\u5efa\u7cfb\u7edf":"\u9009\u62e9\u7cfb\u7edf\u914d\u7f6e"),r.a.createElement("div",{className:"app__os-list"},t?r.a.createElement("div",{style:{marginTop:100,textAlign:"center"}},r.a.createElement(U.a,{title:"\u82e5\u6253\u5f00\u7684\u9875\u9762\u62a5\u9519\uff0c\u8bf7\u91cd\u65b0\u70b9\u51fb"},r.a.createElement(N.a,{size:"large",color:"primary",variant:"outlined",onClick:function(){var e=JSON.parse(L("containerInfo"));window.open(e.shareUrl)},style:{margin:10}},"\u6253\u5f00\u5df2\u521b\u5efa\u7684\u7cfb\u7edf")),r.a.createElement(N.a,{size:"large",color:"secondary",variant:"outlined",onClick:this.handleSelectAgain,style:{margin:10}},"\u91cd\u65b0\u9009\u62e9")):r.a.createElement(Y,{okCallback:this.handleOkCallback}))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(363);i.a.render(r.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[165,2,1]]]);
//# sourceMappingURL=main.2f522f72.chunk.js.map